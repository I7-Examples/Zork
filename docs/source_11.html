<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <title>Infocom -- Ported by Dean Menezes - Zork — 13 of 13</title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="author" content="Infocom -- Ported by Dean Menezes" />
  <meta name="description" content="A page for the game Zork by Infocom -- Ported by Dean Menezes." />
  <link rel="stylesheet" href="style.css" type="text/css" media="all" />
</head>

<body>

<div class = "container">

<div class ="sourcecoverimage">
	<span><a href="Cover.jpg"><img src="Small Cover.jpg" border="1"></a></span>
</div>

<div class ="sourceintroduction">
	<h1>
		<span>Zork</span> <span class="pagination">— 13 of 13</span>
	</h1>
	<h2>
		<span>Infocom -- Ported by Dean Menezes</span>
	</h2>
	<div class ="sourcebibliography">
		<span>Release 4</span>
	</div>
</div>

<div class = "links">
<ul>
<li><a href="index.html">Home page</a></li><li><a href="source.html">Beginning</a></li><li><a href="source_10.html">Previous</a></li>
</ul>
</div>

<div class = "source">
<p class="indent0"><span class="heading">Part 12 - The End Game</span></p><p class="indent0">To decide what indexed text is the encryption of (x - an indexed text):</p><p class="indent0">let keyw be {5, 3, 15, 22, 24, 18, 13, 19};</p><p class="indent0">let outw be an indexed text;</p><p class="indent0">let uinws be 0;</p><p class="indent0">let usum be 0;</p><p class="indent0">let inw be a list of numbers;</p><p class="indent0">let i be 1;</p><p class="indent0">let j be 1;</p><p class="indent0">now outw is &quot;<span class="quote">[</span><span class="substitution">8 spaces</span><span class="quote">]</span>&quot;;</p><p class="indent0">let len be the number of characters in x;</p><p class="indent0">let a be character number 1 in x; <span class="comment">[ to appease scoping rules ]</span></p><p class="indent0">while i is at most 8 begin;</p><p class="indent0">  if j is greater than len, now j is 1;</p><p class="indent0">  let a be character number j in x;</p><p class="indent0">  if a matches the regular expression &quot;<span class="quote">&lt;^A-Z&gt;</span>&quot;, now j is 1;</p><p class="indent0">  let a be character number j in x;</p><p class="indent0">  let b be the alphabet position of a;</p><p class="indent0">  add b to inw;</p><p class="indent0">  increase uinws by b;</p><p class="indent0">  increase i by 1;</p><p class="indent0">  increase j by 1;</p><p class="indent0">end while;</p><p class="indent0">now usum is (the remainder after dividing uinws by 8) + 56;</p><p class="indent0">now i is 1;</p><p class="indent0">while i is at most 8 begin;</p><p class="indent0">  let c be entry i of inw;</p><p class="indent0">  let b be entry i of keyw;</p><p class="indent0">  now j is the twiddle of c and b and usum;</p><p class="indent0">  now j is the remainder after dividing j by 32;</p><p class="indent0">  if j is greater than 26, now j is the remainder after dividing j by 26;</p><p class="indent0">  now a is character number j in the alphabet;</p><p class="indent0">  replace character number i in outw with a;</p><p class="indent0">  now usum is the remainder after dividing (usum + 1) by 32;</p><p class="indent0">  increase i by 1;</p><p class="indent0">end while;</p><p class="indent0">decide on outw.</p><p class="indent0">To decide what number is the twiddle of (a - a number) and (b - a number) and (c - a number):</p><p class="indent0">  (-<span class="i6code"> xor(xor({a},{b}),{c}) </span>-).</p><p class="indent0">To decide which number is the alphabet position of (n - an indexed text):</p><p class="indent0">if n is &quot;<span class="quote">A</span>&quot;, decide on 1;</p><p class="indent0">if n is &quot;<span class="quote">B</span>&quot;, decide on 2;</p><p class="indent0">if n is &quot;<span class="quote">C</span>&quot;, decide on 3;</p><p class="indent0">if n is &quot;<span class="quote">D</span>&quot;, decide on 4;</p><p class="indent0">if n is &quot;<span class="quote">E</span>&quot;, decide on 5;</p><p class="indent0">if n is &quot;<span class="quote">F</span>&quot;, decide on 6;</p><p class="indent0">if n is &quot;<span class="quote">G</span>&quot;, decide on 7;</p><p class="indent0">if n is &quot;<span class="quote">H</span>&quot;, decide on 8;</p><p class="indent0">if n is &quot;<span class="quote">I</span>&quot;, decide on 9;</p><p class="indent0">if n is &quot;<span class="quote">J</span>&quot;, decide on 10;</p><p class="indent0">if n is &quot;<span class="quote">K</span>&quot;, decide on 11;</p><p class="indent0">if n is &quot;<span class="quote">L</span>&quot;, decide on 12;</p><p class="indent0">if n is &quot;<span class="quote">M</span>&quot;, decide on 13;</p><p class="indent0">if n is &quot;<span class="quote">N</span>&quot;, decide on 14;</p><p class="indent0">if n is &quot;<span class="quote">O</span>&quot;, decide on 15;</p><p class="indent0">if n is &quot;<span class="quote">P</span>&quot;, decide on 16;</p><p class="indent0">if n is &quot;<span class="quote">Q</span>&quot;, decide on 17;</p><p class="indent0">if n is &quot;<span class="quote">R</span>&quot;, decide on 18;</p><p class="indent0">if n is &quot;<span class="quote">S</span>&quot;, decide on 19;</p><p class="indent0">if n is &quot;<span class="quote">T</span>&quot;, decide on 20;</p><p class="indent0">if n is &quot;<span class="quote">U</span>&quot;, decide on 21;</p><p class="indent0">if n is &quot;<span class="quote">V</span>&quot;, decide on 22;</p><p class="indent0">if n is &quot;<span class="quote">W</span>&quot;, decide on 23;</p><p class="indent0">if n is &quot;<span class="quote">X</span>&quot;, decide on 24;</p><p class="indent0">if n is &quot;<span class="quote">Y</span>&quot;, decide on 25;</p><p class="indent0">if n is &quot;<span class="quote">Z</span>&quot;, decide on 26.</p><p class="indent0">The alphabet is an indexed text variable.  The alphabet is <span class="comment">[always]</span> &quot;<span class="quote">ABCDEFGHIJKLMNOPQRSTUVWXYZ</span>&quot;.</p><p class="indent0">Check exiting when the player is in a river:</p><p class="indent0">  say &quot;<span class="quote">You realize, just in time, that disembarking here would probably be fatal.</span>&quot; instead.</p><p class="indent0">Incanting is an action applying to one topic.  Understand &quot;<span class="quote">incant [</span><span class="substitution">text</span><span class="quote">]</span>&quot; as incanting.</p><p class="indent0">Check incanting:</p><p class="indent0">if endgame flag is true, say &quot;<span class="quote">[</span><span class="substitution">one of</span><span class="quote">]Sorry, only one incantation to a customer.[</span><span class="substitution">or</span><span class="quote">]Incantations are useless once you have gotten this far[</span><span class="substitution">at random</span><span class="quote">]</span>&quot; instead.</p><p class="indent0">Carry out incanting:</p><p class="indent0">let i be the number of words in the topic understood;</p><p class="indent0">  let a be word number one in the topic understood;</p><p class="indent0">  now a is &quot;<span class="quote">[</span><span class="substitution">a in upper case</span><span class="quote">]</span>&quot;;</p><p class="indent0">  let b be word number two in the topic understood;</p><p class="indent0">  now b is &quot;<span class="quote">[</span><span class="substitution">b in upper case</span><span class="quote">]</span>&quot;;</p><p class="indent0">if i is 1 begin;</p><p class="indent0">  if the player is not in Crypt of the Implementors, say &quot;<span class="quote">That spell has no obvious effect.</span>&quot; instead;</p><p class="indent0">  if not in darkness, say  &quot;<span class="quote">That spell has no obvious effect.</span>&quot; instead;</p><p class="indent0">  if the player is carrying something lit, say &quot;<span class="quote">That spell has no obvious effect.</span>&quot; instead;</p><p class="indent0">  let b be character number 1 in a;</p><p class="indent0">  if b matches the regular expression &quot;<span class="quote">&lt;^A-Z&gt;</span>&quot;, say &quot;<span class="quote">Sorry, your secret word must begin with a letter.</span>&quot; instead;</p><p class="indent0">  say &quot;<span class="quote">A hollow voice replies '[</span><span class="substitution">encryption of a</span><span class="quote">]'</span>&quot;;</p><p class="indent0">  now the score is 621;</p><p class="indent0">  now endgame flag is true;</p><p class="indent0">  move the battery-powered brass lantern to the player;</p><p class="indent0">  move the sword to the player;</p><p class="indent0">  move the player to Top of Stairs;</p><p class="indent0">else if i is 2;</p><p class="indent0"> let c be character number one in a;</p><p class="indent0">  let d be character number one in b;</p><p class="indent0"> if c matches the regular expression &quot;<span class="quote">&lt;^A-Z&gt;</span>&quot;, say &quot;<span class="quote">That spell has no obvious effect.</span>&quot; instead;</p><p class="indent0">  if d matches the regular expression &quot;<span class="quote">&lt;^A-Z&gt;</span>&quot;, say &quot;<span class="quote">That spell has no obvious effect.</span>&quot;;</p><p class="indent0">  let ee be the encryption of a;</p><p class="indent0">  let f be the encryption of b;</p><p class="indent0">  if ee is b, skip to the endgame instead;</p><p class="indent0">  if f is a, skip to the endgame instead;</p><p class="indent0">  say &quot;<span class="quote">That spell has no obvious effect.</span>&quot;;</p><p class="indent0">else;</p><p class="indent0">  say &quot;<span class="quote">That spell has no obvious effect.</span>&quot;;</p><p class="indent0">end if.</p><p class="indent0">To skip to the endgame:</p><p class="indent0">say &quot;<span class="quote">As the last syllable of your spell fades into silence, darkness</span></p><p class="indent0"><span class="quote">envelops you, and the earth shakes briefly.  Then all is quiet.</span>&quot;;</p><p class="indent0">now the score is 621;</p><p class="indent0">now endgame flag is true;</p><p class="indent0">now the sword is touched;</p><p class="indent0">now the battery-powered brass lantern is touched;</p><p class="indent0">move the battery-powered brass lantern to the player;</p><p class="indent0">move the sword to the player;</p><p class="indent0">move the player to Top of Stairs.</p><p class="indent0">Endgame flag is a truth state that varies.  Endgame flag is false.</p><p class="indent0">Top of Stairs is a room.  The description of Top of Stairs is &quot;<span class="quote">You are standing at the top of a flight of stairs that lead down to a passage below.  Dim light, as from torches, can be seen in the passage.  Behind you the stairs lead into untouched rock.</span>&quot;</p><p class="indent0">The rval of Top of Stairs is 10.</p><p class="indent0">Check going south from Top of Stairs:  say &quot;<span class="quote">The wall is solid rock.</span>&quot; instead.</p><p class="indent0">North of Top of Stairs is Stone Room.  Down from Top of Stairs is Stone Room.</p><p class="indent0">The description of Stone Room is &quot;<span class="quote">You are standing near one end of a long, dimly lit hall.  At the south stone stairs ascend.  To the north the corridor is illuminated</span></p><p class="indent0"><span class="quote">by torches set high in the walls, out of reach.  On one wall is a red</span></p><p class="indent0"><span class="quote">button.</span>&quot; A thing called a redbutton is in Stone Room.  Understand &quot;<span class="quote">red</span>&quot; and &quot;<span class="quote">button</span>&quot; and &quot;<span class="quote">switch</span>&quot; as the redbutton. The redbutton is scenery.  The printed name of the redbutton is &quot;<span class="quote">red button</span>&quot;.</p><p class="indent0">The redbutton has a truth state called depressed. The depressed of the redbutton is false.</p><p class="indent0">Beam stopped is a truth state that varies.  Beam stopped is false.</p><p class="indent0">Mrint is a number that varies.  Mrint is -1.</p><p class="indent0">Check pushing the redbutton:</p><p class="indent0">  if the depressed of the redbutton is true begin;</p><p class="indent0">    say &quot;<span class="quote">The button is already depressed.</span>&quot; instead;</p><p class="indent0">  else;</p><p class="indent0">    say &quot;<span class="quote">The button becomes depressed.</span>&quot;;</p><p class="indent0">    if beam stopped is false begin;</p><p class="indent0">      say &quot;<span class="quote">The button pops back out.</span>&quot; instead;</p><p class="indent0">    else;</p><p class="indent0">      now mirror open is true;</p><p class="indent0">      now mrint is 7 instead;</p><p class="indent0">    end if;</p><p class="indent0"> end if.</p><p class="indent0">North of Stone Room is a room called Small Room 2.  The description of Small Room 2 is &quot;<span class="quote">You are in a small room, with narrow passages exiting to the north</span></p><p class="indent0"><span class="quote">and south.  A narrow red beam of light crosses the room at the north</span></p><p class="indent0"><span class="quote">end, inches above the floor.[</span><span class="substitution">if beam stopped is true</span><span class="quote">]The beam is stopped halfway across the room by a sword lying on the floor.[</span><span class="substitution">end if</span><span class="quote">]</span>&quot;.</p><p class="indent0">The printed name of Small Room 2 is &quot;<span class="quote">Small Room</span>&quot;.</p><p class="indent0">A red beam of light is in Small Room 2.  The red beam of light is scenery.</p><p class="indent0">Check destroying the beam of light with something:</p><p class="indent0">try dropping the second noun instead.</p><p class="indent0">After dropping the sword when beam stopped is false and the player can see the beam of light:</p><p class="indent0">  say &quot;<span class="quote">The beam is now blocked by a sword lying on the floor.</span>&quot;;</p><p class="indent0">  now beam stopped is true.</p><p class="indent0">After taking the sword when beam stopped is true and the player can see the beam of light:</p><p class="indent0">  now beam stopped is false.</p><p class="indent0">Check taking the beam of light:</p><p class="indent0">  say &quot;<span class="quote">No doubt you have a bottle of moonbeams as well.</span>&quot; instead.</p><p class="indent0">Check saving the game when endgame flag is true: say &quot;<span class="quote">Saves are not permitted during the end game.</span>&quot; instead. </p><p class="indent0">North of Small Room 2 is a room called Hallway.  The description of Hallway is &quot;<span class="quote">This is part of the long hallway.  The east and west walls are dressed stone.  In the center of the hall is a shallow stone channel. In the center of the room the channel widens into a large hole around which is engraved a compass rose. A passage enters from the south. A large mirror fills the north side of the hallway.[</span><span class="substitution">if mirror open is true</span><span class="quote">]  The mirror is mounted on a panel which has been opened outward.[</span><span class="substitution">end if</span><span class="quote">]</span>&quot;.</p><p class="indent0">The miror is a thing in Hallway.  The miror is scenery.  Understand &quot;<span class="quote">mirror</span>&quot; and &quot;<span class="quote">panel</span>&quot; as the miror.  Instead of entering the miror: try going inside instead.</p><p class="indent0">Check going inside when the player is in Hallway and mirror open is true and Room Number is 1:</p><p class="indent0">move the player to InsideMirror instead.</p><p class="indent0">Mirror open is a truth state that varies. Mirror open is false.</p><p class="indent0">Room Number is a number that varies.  Room Number is 1.  Mirror direction is a direction that varies. Mirror direction is usually west. Pole up is a truth state that varies.  Pole up is usually false.</p><p class="indent0">InsideMirror is a room with printed name &quot;<span class="quote">Inside Mirror</span>&quot;.  The description of InsideMirror is </p><p class="indent0">&quot;<span class="quote">[</span><span class="substitution">5 spaces</span><span class="quote">]You are inside a rectangular box of wood whose structure is rather</span></p><p class="indent0"><span class="quote">complicated.  Four sides and the roof are filled in, and the floor is</span></p><p class="indent0"><span class="quote">open.[</span><span class="substitution">paragraph break</span><span class="quote">]</span></p><p class="indent0"><span class="quote">[</span><span class="substitution">5 spaces</span><span class="quote">]As you face the side opposite the entrance, two short sides of</span></p><p class="indent0"><span class="quote">carved and polished wood are to your left and right.  The left panel</span></p><p class="indent0"><span class="quote">is mahogany, the right pine.  The wall you face is red on its left</span></p><p class="indent0"><span class="quote">half and black on its right.  On the entrance side, the wall is white</span></p><p class="indent0"><span class="quote">opposite the red part of the wall it faces, and yellow opposite the</span></p><p class="indent0"><span class="quote">black section.  The painted walls are at least twice the length of</span></p><p class="indent0"><span class="quote">the unpainted ones.  The ceiling is painted blue.[</span><span class="substitution">paragraph break</span><span class="quote">]</span></p><p class="indent0"><span class="quote">[</span><span class="substitution">5 spaces</span><span class="quote">]In the floor is a stone channel about six inches wide and a foot</span></p><p class="indent0"><span class="quote">deep.  The channel is oriented in a north-south direction.  In the</span></p><p class="indent0"><span class="quote">exact center of the room the channel widens into a circular</span></p><p class="indent0"><span class="quote">depression perhaps two feet wide.  Incised in the stone around this</span></p><p class="indent0"><span class="quote">area is a compass rose.[</span><span class="substitution">paragraph break</span><span class="quote">]</span></p><p class="indent0"><span class="quote">[</span><span class="substitution">5 spaces</span><span class="quote">]Running from one short wall to the other at about waist height</span></p><p class="indent0"><span class="quote">is a wooden bar, carefully carved and drilled.  This bar is pierced</span></p><p class="indent0"><span class="quote">in two places.  The first hole is in the center of the bar (and thus</span></p><p class="indent0"><span class="quote">the center of the room).  The second is at the left end of the room</span></p><p class="indent0"><span class="quote">(as you face opposite the entrance).  Through each hole runs a wooden</span></p><p class="indent0"><span class="quote">pole.[</span><span class="substitution">paragraph break</span><span class="quote">]</span></p><p class="indent0"><span class="quote">[</span><span class="substitution">5 spaces</span><span class="quote">]The pole at the left end of the bar is short, extending about a foot</span></p><p class="indent0"><span class="quote">above the bar, and ends in a hand grip.  The pole is [</span><span class="substitution">if pole up is true</span><span class="quote">]up[</span><span class="substitution">otherwise</span><span class="quote">]down[</span><span class="substitution">end if</span><span class="quote">].[</span><span class="substitution">paragraph break</span><span class="quote">]</span></p><p class="indent0"><span class="quote">[</span><span class="substitution">5 spaces</span><span class="quote">]The long pole at the center of the bar extends from the ceiling</span></p><p class="indent0"><span class="quote">through the bar to the circular area in the stone channel.  This</span></p><p class="indent0"><span class="quote">bottom end of the pole has a T-bar a bit less than two feet long</span></p><p class="indent0"><span class="quote">attached to it, and on the T-bar is carved an arrow.  The arrow and</span></p><p class="indent0"><span class="quote">T-bar are pointing [</span><span class="substitution">Mirror direction</span><span class="quote">].</span>&quot;</p><p class="indent0">The yellow panel is scenery.</p><p class="indent0">A short pole is a thing in InsideMirror.  A long pole is a thing in InsideMirror.  A mahogany panel is a thing in InsideMirror.  A pine panel is a thing in InsideMirror.  A red panel is a thing in InsideMirror.  A yellow panel is a thing in InsideMirror.  The short pole, the long pole, the mahogany panel, the pine panel, the red panel, and the white panel are scenery.  Understand &quot;<span class="quote">wall</span>&quot; as the red panel. Understand &quot;<span class="quote">wall</span>&quot; as the pine panel.</p><p class="indent0">Understand &quot;<span class="quote">wall</span>&quot; as the yellow panel.  Understand &quot;<span class="quote">wall</span>&quot; as the mahogany panel.</p><p class="indent0">Understand &quot;<span class="quote">yellow</span>&quot; as the red panel.  Understand &quot;<span class="quote">black</span>&quot; as the white panel.</p><p class="indent0">Check pushing the red panel:</p><p class="indent0">  if the pole up is true begin; </p><p class="indent0">    say &quot;<span class="quote">The structure rotates clockwise.</span>&quot;;</p><p class="indent0">if mirror direction is west begin;</p><p class="indent0">  now mirror direction is northwest;</p><p class="indent0">else if mirror direction is northwest;</p><p class="indent0">  now mirror direction is north;</p><p class="indent0">else if mirror direction is north;</p><p class="indent0">  now mirror direction is northeast;</p><p class="indent0">else if mirror direction is northeast;</p><p class="indent0">  now mirror direction is east;</p><p class="indent0">else if mirror direction is east;</p><p class="indent0">  now mirror direction is southeast;</p><p class="indent0">else if mirror direction is southeast;</p><p class="indent0">  now mirror direction is south;</p><p class="indent0">else if mirror direction is south;</p><p class="indent0">  now mirror direction is south;</p><p class="indent0">else if mirror direction is south;</p><p class="indent0">  now mirror direction is west;</p><p class="indent0">end if;</p><p class="indent0">say &quot;<span class="quote">The arrow is now pointing [</span><span class="substitution">Mirror direction</span><span class="quote">].</span>&quot; instead;</p><p class="indent0">  else;</p><p class="indent0">    say &quot;<span class="quote">The short pole stops the structure from rotating.</span>&quot; instead;</p><p class="indent0">end if.</p><p class="indent0">Check pushing the white panel:</p><p class="indent0">  if the pole up is true begin; </p><p class="indent0">    say &quot;<span class="quote">The structure rotates counterclockwise.</span>&quot;;</p><p class="indent0">if mirror direction is west begin;</p><p class="indent0">  now mirror direction is south;</p><p class="indent0">else if mirror direction is northwest;</p><p class="indent0">  now mirror direction is west;</p><p class="indent0">else if mirror direction is north;</p><p class="indent0">  now mirror direction is northwest;</p><p class="indent0">else if mirror direction is northeast;</p><p class="indent0">  now mirror direction is north;</p><p class="indent0">else if mirror direction is east;</p><p class="indent0">  now mirror direction is northeast;</p><p class="indent0">else if mirror direction is southeast;</p><p class="indent0">  now mirror direction is east;</p><p class="indent0">else if mirror direction is south;</p><p class="indent0">  now mirror direction is southeast;</p><p class="indent0">else if mirror direction is south;</p><p class="indent0">  now mirror direction is south;end if;</p><p class="indent0">say &quot;<span class="quote">The arrow is now pointing [</span><span class="substitution">Mirror direction</span><span class="quote">].</span>&quot; instead;</p><p class="indent0">  else;</p><p class="indent0">    say &quot;<span class="quote">The short pole stops the structure from rotating.</span>&quot; instead;</p><p class="indent0">end if.</p><p class="indent0">Check lifting the short pole:</p><p class="indent0"> if pole up is true begin;</p><p class="indent0">   say &quot;<span class="quote">The pole cannot be raised further.</span>&quot; instead;</p><p class="indent0"> else;</p><p class="indent0">   say &quot;<span class="quote">The pole is now slightly above the floor.</span>&quot;;</p><p class="indent0">   now pole up is true instead;</p><p class="indent0"> end if.</p><p class="indent0">Check lowering the short pole:</p><p class="indent0"> if pole up is true begin;</p><p class="indent0">   say &quot;<span class="quote">The pole is lowered into the channel.</span>&quot;;</p><p class="indent0">   now pole up is false instead;</p><p class="indent0"> else;</p><p class="indent0">   say &quot;<span class="quote">The pole cannot be lowered further.</span>&quot; instead;</p><p class="indent0"> end if.</p><p class="indent0">Check pushing the mahogany panel:</p><p class="indent0">if mirror direction is not north and mirror direction is not south begin;</p><p class="indent0">  say &quot;<span class="quote">The structure rocks back and forth slightly but doesn't move.</span>&quot; instead;</p><p class="indent0">else if mirror direction is north;</p><p class="indent0">if room number is 2 and pole up is true begin;</p><p class="indent0">say &quot;<span class="quote">The structure wobbles north and stops over another compass rose.[</span><span class="substitution">paragraph break</span><span class="quote">]</span>&quot;;</p><p class="indent0">say &quot;<span class="quote">The structure wobbles as it moves, alerting the Guardians.[</span><span class="substitution">paragraph break</span><span class="quote">]</span>&quot;;</p><p class="indent0">say &quot;<span class="quote">Suddenly, the Guardians realize that someone is trying to sneak by them in the structure.  They awake and, in perfect unison, hammer the box and its contents (including you) to pulp.  Satisfied, they then resume their posts.[</span><span class="substitution">paragraph break</span><span class="quote">]</span>&quot;;</p><p class="indent0">end the game in death instead;</p><p class="indent0">else if pole up is true;</p><p class="indent0">  if room number is 4 begin;</p><p class="indent0">    say &quot;<span class="quote">The structure has reached the end of the stone channel and won't budge.</span>&quot; instead;</p><p class="indent0">  else if room number is 3;</p><p class="indent0">    say &quot;<span class="quote">The structure wobbles north and stops over another compass rose.</span>&quot;;</p><p class="indent0">    now room number is 4 instead;</p><p class="indent0">  else if room number is 2;</p><p class="indent0">    say &quot;<span class="quote">The structure wobbles north and stops over another compass rose.</span>&quot;;</p><p class="indent0">    now room number is 3 instead;</p><p class="indent0">   else if room number is 1;</p><p class="indent0">     say &quot;<span class="quote">The structure wobbles north and stops over another compass rose.</span>&quot;;</p><p class="indent0">     now room number is 2 instead;</p><p class="indent0">   end if;</p><p class="indent0">else;</p><p class="indent0">  if room number is 4 begin;</p><p class="indent0">    say &quot;<span class="quote">The structure has reached the end of the stone channel and won't budge.</span>&quot; instead;</p><p class="indent0">  else if room number is 3;</p><p class="indent0">     say &quot;<span class="quote">The structure slides north and stops over another compass rose.</span>&quot;;</p><p class="indent0">    now room number is 4 instead;</p><p class="indent0">  else if room number is 2;</p><p class="indent0">     say &quot;<span class="quote">The structure slides north and stops over another compass rose.</span>&quot;;</p><p class="indent0">    now room number is 3 instead;</p><p class="indent0">   else if room number is 1;</p><p class="indent0">     say &quot;<span class="quote">The structure slides north and stops over another compass rose.</span>&quot;;</p><p class="indent0">     now room number is 2 instead;</p><p class="indent0">end if;</p><p class="indent0">end if;</p><p class="indent0">else if mirror direction is south;</p><p class="indent0">if room number is 4 and pole up is true begin;</p><p class="indent0">say &quot;<span class="quote">The structure wobbles south and stops over another compass rose.[</span><span class="substitution">paragraph break</span><span class="quote">]</span>&quot;;</p><p class="indent0">say &quot;<span class="quote">The structure wobbles as it moves, alerting the Guardians.[</span><span class="substitution">paragraph break</span><span class="quote">]</span>&quot;;</p><p class="indent0">say &quot;<span class="quote">Suddenly, the Guardians realize that someone is trying to sneak by them in the structure.  They awake and, in perfect unison, hammer the box and its contents (including you) to pulp.  Satisfied, they then resume their posts.[</span><span class="substitution">paragraph break</span><span class="quote">]</span>&quot;;</p><p class="indent0">end the game in death instead;</p><p class="indent0">else if pole up is true;</p><p class="indent0">  if room number is 1 begin;</p><p class="indent0">    say &quot;<span class="quote">The structure has reached the end of the stone channel and won't budge.</span>&quot;;</p><p class="indent0">  else if room number is 2;</p><p class="indent0">    say &quot;<span class="quote">The structure wobbles south and stops over another compass rose.</span>&quot;;</p><p class="indent0">    now room number is 1 instead;</p><p class="indent0">  else if room number is 3;</p><p class="indent0">    say &quot;<span class="quote">The structure wobbles south and stops over another compass rose.</span>&quot;;</p><p class="indent0">    now room number is 2 instead;</p><p class="indent0">   end if;</p><p class="indent0">else;</p><p class="indent0">  if room number is 1 begin;</p><p class="indent0">    say &quot;<span class="quote">The structure has reached the end of the stone channel and won't budge.</span>&quot; instead;</p><p class="indent0">  else if room number is 2;</p><p class="indent0">     say &quot;<span class="quote">The structure slides south and stops over another compass rose.</span>&quot;;</p><p class="indent0">    now room number is 1 instead;</p><p class="indent0">  else if room number is 3;</p><p class="indent0">     say &quot;<span class="quote">The structure slides south and stops over another compass rose.</span>&quot;;</p><p class="indent0">    now room number is 2 instead;</p><p class="indent0">   else if room number is 4;</p><p class="indent0">     say &quot;<span class="quote">The structure slides south and stops over another compass rose.</span>&quot;;</p><p class="indent0">     now room number is 3 instead;</p><p class="indent0">end if;</p><p class="indent0">end if;</p><p class="indent0">end if.</p><p class="indent0">Hallway2 is a room. The printed name of Hallway2 is &quot;<span class="quote">Narrow Hallway</span>&quot;.  The description of Hallway2 is &quot;<span class="quote">This is part of the long hallway.  The east and west walls are</span></p><p class="indent0"><span class="quote">dressed stone.  In the center of the hall is a shallow stone channel.</span></p><p class="indent0"><span class="quote">In the center of the room the channel widens into a large hole around</span></p><p class="indent0"><span class="quote">which is engraved a compass rose.The north side of the room is divided by a wooden wall into small hallways to the northeast and northwest.</span>&quot;</p><p class="indent0">Check pushing the pine panel:</p><p class="indent0">if room number is 4 and mirror direction is north begin;</p><p class="indent0">  say &quot;<span class="quote">The pine door opens into the field of view of the Guardians.[</span><span class="substitution">paragraph break</span><span class="quote">]</span>&quot;;</p><p class="indent0">say &quot;<span class="quote">The Guardians awake and, in perfect unison, destroy you with</span></p><p class="indent0"><span class="quote">their stone bludgeons.  Satisfied, they resume their posts.</span>&quot;;</p><p class="indent0">end the game in death instead;</p><p class="indent0">else if room number is 2 and mirror direction is south;</p><p class="indent0">say &quot;<span class="quote">The pine door opens into the field of view of the Guardians.[</span><span class="substitution">paragraph break</span><span class="quote">]</span>&quot;;</p><p class="indent0">say &quot;<span class="quote">The Guardians awake and, in perfect unison, destroy you with</span></p><p class="indent0"><span class="quote">their stone bludgeons.  Satisfied, they resume their posts.</span>&quot;;</p><p class="indent0">end the game in death instead;</p><p class="indent0">else if room number is 3;</p><p class="indent0">say &quot;<span class="quote">The pine door opens into the field of view of the Guardians.[</span><span class="substitution">paragraph break</span><span class="quote">]</span>&quot;;</p><p class="indent0">say &quot;<span class="quote">The Guardians awake and, in perfect unison, destroy you with</span></p><p class="indent0"><span class="quote">their stone bludgeons.  Satisfied, they resume their posts.</span>&quot;;</p><p class="indent0">end the game in death instead;</p><p class="indent0">else if mirror direction is not north and mirror direction is not south;</p><p class="indent0">say &quot;<span class="quote">The structure rocks back and forth slightly but doesn't move.</span>&quot;;</p><p class="indent0">else;</p><p class="indent0">say &quot;<span class="quote">The pine wall swings open.</span>&quot;;</p><p class="indent0">now mirror open is true instead;</p><p class="indent0">end if.</p><p class="indent0">Check exiting while the location is InsideMirror:</p><p class="indent0">if mirror open is false begin;</p><p class="indent0">  say &quot;<span class="quote">There is no way out.</span>&quot; instead;</p><p class="indent0">else if room number is 1;</p><p class="indent0">  move the player to Hallway instead;</p><p class="indent0">else if room number is 2;</p><p class="indent0">  move the player to Hallway2 instead;</p><p class="indent0">else;</p><p class="indent0">  move the player to Hallway4 instead;</p><p class="indent0">end if.</p><p class="indent0">Northwest of Hallway2 is a room called Narrow Room.  The description of Narrow Room is &quot;<span class="quote">This is a narrow room whose east wall is a large mirror.  Somewhat to the north, identical stone statues face each other from pedestals on opposite sides of the corridor.  The statues represent Guardians of Zork, a military order of ancient lineage.  They are portrayed as heavily armored warriors standing at ease, hands clasped around formidable bludgeons.</span>&quot;</p><p class="indent0">Northeast of Hallway2 is a room called NarrowRoom.  The printed name of Narrow Room is &quot;<span class="quote">Narrow Room</span>&quot;.  The description of NarrowRoom is &quot;<span class="quote">This is a narrow room whose west wall is a large mirror. Somewhat to the north, identical stone statues face each other from</span></p><p class="indent0"><span class="quote">pedestals on opposite sides of the corridor.  The statues represent Guardians of Zork, a military order of ancient lineage.  They are portrayed as heavily armored warriors standing at ease, hands clasped around formidable bludgeons.</span>&quot;</p><p class="indent0">Instead of going north from Narrow Room:</p><p class="indent0">say &quot;<span class="quote">The Guardians awake and, in perfect unison, destroy you with</span></p><p class="indent0"><span class="quote">their stone bludgeons.  Satisfied, they resume their posts.</span>&quot;;</p><p class="indent0">end the game in death.</p><p class="indent0">Instead of going north from NarrowRoom:</p><p class="indent0">say &quot;<span class="quote">The Guardians awake and, in perfect unison, destroy you with</span></p><p class="indent0"><span class="quote">their stone bludgeons.  Satisfied, they resume their posts.</span>&quot;;</p><p class="indent0">end the game in death.</p><p class="indent0">The rval of InsideMirror is 15.</p><p class="indent0">Hallway4 is a room.  The printed name of Hallway4 is &quot;<span class="quote">Dungeon Entrance</span>&quot;.  The description of Hallway4 is &quot;<span class="quote">This is a north-south hallway which ends in a large wooden door. The south side of the room is divided by a wooden wall into small hallways to the southeast and southwest.</span>&quot;</p><p class="indent0">Instead of going southwest from Hallway4:</p><p class="indent0">say &quot;<span class="quote">The Guardians awake and, in perfect unison, destroy you with</span></p><p class="indent0"><span class="quote">their stone bludgeons.  Satisfied, they resume their posts.</span>&quot;;</p><p class="indent0">end the game in death.</p><p class="indent0">Instead of going southeast from Hallway4:</p><p class="indent0">say &quot;<span class="quote">The Guardians awake and, in perfect unison, destroy you with</span></p><p class="indent0"><span class="quote">their stone bludgeons.  Satisfied, they resume their posts.</span>&quot;;</p><p class="indent0">end the game in death.</p><p class="indent0">The large wooden door is a door.  The large wooden door is closed, openable, lockable, and locked.  The large wooden door is north from Hallway4. The large wooden door is scenery. North of the large wooden door is Narrow Corridor.</p><p class="indent0">Narrow Corridor is a room.  The description of Narrow Corridor is &quot;<span class="quote">This is a narrow north-south corridor.  At the south end is a door and at the north end is an east-west corridor.  The door is [</span><span class="substitution">if the large wooden door is open</span><span class="quote">]open.[</span><span class="substitution">otherwise</span><span class="quote">]closed.[</span><span class="substitution">end if</span><span class="quote">]</span>&quot;.</p><p class="indent0">The dungeon master is a man.  Instead of attacking the dungeon master:</p><p class="indent0">say &quot;<span class="quote">The dungeon master is taken momentarily by surprise.  He dodges your</span></p><p class="indent0"><span class="quote">blow and then, with a disappointed expression on his face, he raises</span></p><p class="indent0"><span class="quote">his staff and traces a complicated pattern in the air.  As it</span></p><p class="indent0"><span class="quote">completes you crumble into dust.</span>&quot;; end the game in death.  Instead of attacking the dungeon master with something:</p><p class="indent0">say &quot;<span class="quote">The dungeon master is taken momentarily by surprise.  He dodges your</span></p><p class="indent0"><span class="quote">blow and then, with a disappointed expression on his face, he raises</span></p><p class="indent0"><span class="quote">his staff and traces a complicated pattern in the air.  As it</span></p><p class="indent0"><span class="quote">completes you crumble into dust.</span>&quot;;</p><p class="indent0">end the game in death.</p><p class="indent0">Question number is a number that varies.  Question number is usually 0.</p><p class="indent0">Instead of answering the dungeon master that something:</p><p class="indent0">  if the topic understood matches the text &quot;<span class="quote">follow</span>&quot; begin;</p><p class="indent0">   now follow is true;</p><p class="indent0">   say &quot;<span class="quote">The dungeon master answers, 'I will follow.'</span>&quot;;</p><p class="indent0">  else if the topic understood matches the text &quot;<span class="quote">stay</span>&quot;;</p><p class="indent0">    say &quot;<span class="quote">The dungeon master says, 'I will stay.'</span>&quot;;</p><p class="indent0">    now follow is false;</p><p class="indent0">  else;</p><p class="indent0">    try speaking &quot;<span class="quote">[</span><span class="substitution">the topic understood</span><span class="quote">]</span>&quot;;</p><p class="indent0">  end if.</p><p class="indent0">Instead of speaking when question number is 1:</p><p class="indent0">if the topic understood matches the text &quot;<span class="quote">temple</span>&quot; begin;</p><p class="indent0">  say &quot;<span class="quote">The dungeon master says, 'Excellent.'</span>&quot;;</p><p class="indent0">  now question number is 2;</p><p class="indent0">  now tries left is 4;</p><p class="indent0">  award 5 points;</p><p class="indent0">else if tries left is 0;</p><p class="indent0">  say &quot;<span class="quote">The dungeon master, obviously disappointed in your lack of knowledge, shakes his head and mumbles 'I guess they'll let anyone in the Dungeon these days'.  With</span></p><p class="indent0"><span class="quote">that, he departs.</span>&quot;;</p><p class="indent0">  remove the dungeon master from play;</p><p class="indent0">else if tries left is 1;</p><p class="indent0">  say &quot;<span class="quote">The dungeon master says, 'You are wrong.  You have one more chance.'</span>&quot;;</p><p class="indent0">  now tries left are 0;</p><p class="indent0">else;</p><p class="indent0">  say &quot;<span class="quote">The dungeon master says, 'You are wrong.  You have [</span><span class="substitution">tries left in words</span><span class="quote">] more chances.'</span>&quot;;</p><p class="indent0">  decrease tries left by 1;</p><p class="indent0">end if.</p><p class="indent0">Instead of speaking when question number is 2:</p><p class="indent0">if the topic understood matches the text &quot;<span class="quote">forest</span>&quot; begin;</p><p class="indent0">  say &quot;<span class="quote">The dungeon master says, 'Excellent.'</span>&quot;;</p><p class="indent0">  now question number is 3;</p><p class="indent0">  now tries left are 4;</p><p class="indent0">  award 5 points;</p><p class="indent0">else if tries left is 0;</p><p class="indent0">  say &quot;<span class="quote">The dungeon master, obviously disappointed in your lack of knowledge, shakes his head and mumbles 'I guess they'll let anyone in the Dungeon these days'.  With</span></p><p class="indent0"><span class="quote">that, he departs.</span>&quot;;</p><p class="indent0">  remove the dungeon master from play;</p><p class="indent0">else if tries left is 1;</p><p class="indent0">  say &quot;<span class="quote">The dungeon master says, 'You are wrong.  You have one more chance.'</span>&quot;;</p><p class="indent0">  now tries left are 0;</p><p class="indent0">else;</p><p class="indent0">  say &quot;<span class="quote">The dungeon master says, 'You are wrong.  You have [</span><span class="substitution">tries left in words</span><span class="quote">] more chances.'</span>&quot;;</p><p class="indent0">  decrease tries left by 1;</p><p class="indent0">end if.</p><p class="indent0">Instead of speaking when question number is 3:</p><p class="indent0">if the topic understood matches the text &quot;<span class="quote">touch</span>&quot; or the topic understood matches the text &quot;<span class="quote">rub</span>&quot; begin;</p><p class="indent0">say &quot;<span class="quote">The dungeon master, obviously pleased, says 'You are indeed a</span></p><p class="indent0"><span class="quote">master of lore. I am proud to be at your service.'  The massive</span></p><p class="indent0"><span class="quote">wooden door swings open, and the master motions for you to enter.</span>&quot;;</p><p class="indent0">award 5 points;</p><p class="indent0">now the large wooden door is open;</p><p class="indent0">now the large wooden door is unlocked;</p><p class="indent0">now follow is true;</p><p class="indent0">else if tries left is 0;</p><p class="indent0">  say &quot;<span class="quote">The dungeon master, obviously disappointed in your lack of knowledge, shakes his head and mumbles 'I guess they'll let anyone in the Dungeon these days'.  With</span></p><p class="indent0"><span class="quote">that, he departs.</span>&quot;;</p><p class="indent0">  remove the dungeon master from play;</p><p class="indent0">else if tries left is 1;</p><p class="indent0">  say &quot;<span class="quote">The dungeon master says, 'You are wrong.  You have one more chance.'</span>&quot;;</p><p class="indent0">  now tries left are 0;</p><p class="indent0">else;</p><p class="indent0">  say &quot;<span class="quote">The dungeon master says, 'You are wrong.  You have [</span><span class="substitution">tries left in words</span><span class="quote">] more chances.'</span>&quot;;</p><p class="indent0">  decrease tries left by 1;</p><p class="indent0">end if.</p><p class="indent0">The later appearance of the master is &quot;<span class="quote">The dungeon master is quietly leaning on his staff here.</span>&quot;</p><p class="indent0">Follow is a truth state that varies.  Follow is false.</p><p class="indent0">Tries left is a number that varies.  Tries left is usually 4.</p><p class="indent0">Every turn:</p><p class="indent0">let aaa be the rval of the location;</p><p class="indent0">award aaa points;</p><p class="indent0">now the rval of the location is 0;</p><p class="indent0"> if the thief has been unconsious for four turns and the player can see the thief, say &quot;<span class="quote">The thief returns to consiousness.</span>&quot;;</p><p class="indent0">if the engrossed of the thief has been true for two turn, now the engrossed of the thief is false;</p><p class="indent0">if the player has been in Cage for the tenth turn begin;</p><p class="indent0"> say &quot;<span class="quote">Time passes...and you die from some obscure poisoning.</span>&quot;;</p><p class="indent0"> end the game in death;</p><p class="indent0">end if;</p><p class="indent0"> if the player is in InsideMirror and mirror open has been true for three turns begin;</p><p class="indent0">  say &quot;<span class="quote">The mirror quietly swings shut.</span>&quot;;</p><p class="indent0">  now mirror open is false;</p><p class="indent0"> end if;</p><p class="indent0">if question number is 1 and question number was not 1 begin;</p><p class="indent0">  say  &quot;<span class="quote">The booming voice asks: From which room can one enter the robber's hideaway without passing through the cyclops room?</span>&quot;;</p><p class="indent0">else if question number is 2 and question number was not 2;</p><p class="indent0">  say &quot;<span class="quote">The booming voice asks: Besides the Temple, to which room is it possible to go from the Altar?</span>&quot;;</p><p class="indent0">else if question number is 3 and question number was not 3;</p><p class="indent0">   say &quot;<span class="quote">The booming voice asks: What can be done to the Mirror that is useful?</span>&quot;;</p><p class="indent0">end if;</p><p class="indent0">if the thief carries the jewel-encrusted egg, now the jewel-encrusted egg is open;</p><p class="indent0">if the player is in Treasure Room and the thief is not in Treasure Room and the thief is on-stage begin;</p><p class="indent0">  say &quot;<span class="quote">You hear a scream of anguish as you violate the robber's hideaway.  Using passages unknown to you, he rushes to its defense.</span>&quot;;</p><p class="indent0">  move the thief to Treasure Room;</p><p class="indent0">end if;</p><p class="indent0">if the thief is on-stage begin;</p><p class="indent0">if the thief cannot see the player, try the thief escaping;</p><p class="indent0">if the thief is not in Treasure Room and the player is in the holder of the thief begin;</p><p class="indent0">if the thief can see a visible valuble thing which is not held by the thief begin;</p><p class="indent0">  say &quot;<span class="quote">A seedy-looking individual with a large bag just wandered through the room.  On the way through, he quietly abstracted all valuables from the room and from your possession, mumbling something about 'Doing unto others before...'</span>&quot;;</p><p class="indent0">  now every valuble thing had by the player is had by the thief;</p><p class="indent0">  now every visible valuble thing in the location is had by the thief;</p><p class="indent0">  try the thief escaping;</p><p class="indent0">else;</p><p class="indent0">  say &quot;<span class="quote">A seedy-looking individual with a large bag just wandered through the room.  Finding nothing of value, he left disgruntled.</span>&quot;;</p><p class="indent0">end if;</p><p class="indent0">  try the thief escaping;</p><p class="indent0">end if;</p><p class="indent0">end if;</p><p class="indent0">  if follow is true and the player is not in the holder of the dungeon master begin;</p><p class="indent0">    say &quot;<span class="quote">The dungeon master follows you.</span>&quot;;</p><p class="indent0">    move the dungeon master to the holder of the player;</p><p class="indent0">  end if;</p><p class="indent0">  decrease mrint by 1;</p><p class="indent0">  if mrint is 0 begin;</p><p class="indent0">    now mirror open is true;</p><p class="indent0">    if the player can see the redbutton, say &quot;<span class="quote">The button pops back to its original position.</span>&quot;;</p><p class="indent0">   now the depressed of the redbutton is false;</p><p class="indent0">  end if;</p><p class="indent0">if the player has been in Vault for exactly 4 turns begin; say &quot;<span class="quote">A metallic voice says, 'Hello, Intruder!  Your unauthorized presence in the vault area of the Bank of Zork has set off all sorts of nasty surprises, several of which seem to have been fatal.  This message brought to you by the Frobozz Magic Alarm Company.'</span>&quot;; end the game in death; end if;</p><p class="indent0">if gnome flag is true and the player has been in Small Room for exactly 4 turns begin; say &quot;<span class="quote">An epicene Gnome of Zurich, wearing a three-piece suit and carrying a</span></p><p class="indent0"><span class="quote"> safety deposit box, materializes in the room.  'You seem to have</span></p><p class="indent0"><span class="quote"> forgotten to deposit your valuables,' he says, tapping the lid of the</span></p><p class="indent0"><span class="quote"> box impatiently.  'We don't usually allow customers to use the boxes</span></p><p class="indent0"><span class="quote"> here, but we can make this ONE exception, I suppose...'  He looks</span></p><p class="indent0"><span class="quote"> askance at you over his wire-rimmed bifocals.</span>&quot;; move the Gnome of Zurich to Small Room; now gnome flag is false; end if;</p><p class="indent0">if the player is in Grating Room, now the grating is revealed;</p><p class="indent0">if the location is the bad place and the brick is off-stage, foo;</p><p class="indent0">if the number of moves from the location to the bad place is 1 and the brick is off-stage, foo;</p><p class="indent0">if squish clock is 0 begin;</p><p class="indent0">now the description of the bad place is &quot;<span class="quote">[</span><span class="substitution">pizza</span><span class="quote">]</span>&quot;;</p><p class="indent0">if the player is in the bad place begin;</p><p class="indent0">  say &quot;<span class="quote">The room trembles and 50,000 pounds of rock fall on you, turning you into a pancake.  [</span><span class="substitution">if the player is outdoors</span><span class="quote">]Meteors, no doubt.[</span><span class="substitution">end if</span><span class="quote">]</span>&quot;;</p><p class="indent0">  end the game in death;</p><p class="indent0">else;</p><p class="indent0">  say &quot;<span class="quote">You may recall your recent explosion.  Well, probably as a result of</span></p><p class="indent0"><span class="quote">that, you hear an ominous rumbling, as if one of the rooms in the</span></p><p class="indent0"><span class="quote">dungeon has collapsed.</span>&quot;;</p><p class="indent0">   <a name="note1ref"></a><span class="notecue"><a href="#note1">[1]</a></span></p><p class="indent0">end if;</p><p class="indent0">end if;</p><p class="indent0">decrease squish clock by 1;</p><p class="indent0">decrease ledge clock by 1;</p><p class="indent0">if ledge clock is 3, say &quot;<span class="quote">You may recall your recent explosion.  Well, probably as a result of that, you hear an ominous rumbling, as if one of the rooms in the</span></p><p class="indent0"><span class="quote">dungeon has collapsed.</span>&quot;;</p><p class="indent0">if ledge clock is 0 begin;</p><p class="indent0">  if the player is in the basket and the basket is in Wide Ledge begin;</p><p class="indent0">    if the braided wire is attached to the tiny hook begin;</p><p class="indent0">      say &quot;<span class="quote">The ledge collapses, probably as a result of the explosion.  A large</span></p><p class="indent0"><span class="quote">chunk of it, which is attached to the hook, drags you down to the</span></p><p class="indent0"><span class="quote">ground.  Fatally.</span>&quot;;</p><p class="indent0">      end the game in death;</p><p class="indent0">    else;</p><p class="indent0">       say &quot;<span class="quote">The ledge collapses, leaving you with no place to land.</span>&quot;;</p><p class="indent0">       move the basket to Volcano Near WideLedge;</p><p class="indent0">       try looking;</p><p class="indent0">    end if;</p><p class="indent0">  else if the player is in Wide Ledge or the player is in Dusty Room;</p><p class="indent0">    say &quot;<span class="quote">The force of the explosion has caused the ledge to collapse</span></p><p class="indent0"><span class="quote">belatedly.</span>&quot;;</p><p class="indent0">    end the game in death;</p><p class="indent0">  else;</p><p class="indent0">    say &quot;<span class="quote">The ledge collapses, giving you a narrow escape.</span>&quot;;</p><p class="indent0">  end if;</p><p class="indent0">end if;</p><p class="indent0">if wire clock is 0 begin;</p><p class="indent0">  if the player can see the brick begin;</p><p class="indent0">      say &quot;<span class="quote">Now you've done it.  It seems that the brick has other properties</span></p><p class="indent0"><span class="quote">than weight, namely the ability to blow you to smithereens.</span>&quot;;</p><p class="indent0">  remove the brick from play;</p><p class="indent0">  end the game in death;</p><p class="indent0">  else;</p><p class="indent0">   say &quot;<span class="quote">There is an explosion nearby.</span>&quot;;</p><p class="indent0">   if the brick is in the oblong hole begin;</p><p class="indent0">       now ledge clock is 5;</p><p class="indent0">       now the rusty box is open;</p><p class="indent0">       move the crown to Dusty Room;</p><p class="indent0">       move the note card to Dusty Room;</p><p class="indent0">    else if the brick is in Dusty Room;</p><p class="indent0">       now ledge clock is 5;</p><p class="indent0">   else;</p><p class="indent0">     now squish clock is 2;</p><p class="indent0">     now the bad place is the location of the brick;</p><p class="indent0">   end if;</p><p class="indent0">   remove the brick from play;</p><p class="indent0"> end if;</p><p class="indent0">end if;</p><p class="indent0">decrease wire clock by 1;</p><p class="indent0">if burn interrupt is 0 begin;</p><p class="indent0">  if something visible is in the receptacle, say &quot;<span class="quote">You notice that the [</span><span class="substitution">list of flaming things in the receptacle</span><span class="quote">] has burned out, and that the cloth bag starts to deflate.</span>&quot;;</p><p class="indent0">  let the thingy be a random flaming  thing in the receptacle;</p><p class="indent0">  now the thingy is not flaming;</p><p class="indent0">  remove the thingy from play;</p><p class="indent0">end if;</p><p class="indent0">decrease burn interrupt by 1;</p><p class="indent0">now every thing which is flaming is lit;</p><p class="indent0">if something inflammable (called the thingy) is non-flaming, now the thingy is unlit;</p><p class="indent0">if the matchbook is non-flaming, now the matchbook is unlit;</p><p class="indent0">if the pair of candles is non-flaming, now the pair of candles is unlit;</p><p class="indent0">if match tick is greater than 0, decrease match tick by 1;</p><p class="indent0">if match tick is 0 begin;</p><p class="indent0">  say &quot;<span class="quote">The match has gone out.</span>&quot;;</p><p class="indent0">  now match tick is -1;</p><p class="indent0">  now the matchbook is non-flaming;</p><p class="indent0">end if;</p><p class="indent0">  if the cure wait of the player is greater than 0, decrease the cure wait of the player by 1;</p><p class="indent0">  if the cure wait of the player is 0, now the wounds of the player are 0;</p><p class="indent0">  if the wounds of the player is greater than 4 begin;</p><p class="indent0">    say &quot;<span class="quote">It appears that blow was too much for you.  I'm afraid you are dead.</span>&quot;;</p><p class="indent0">    now the wounds of the player are 4;</p><p class="indent0">    end the game in death;</p><p class="indent0">  end if;</p><p class="indent0">  if the battery-powered brass lantern is switched on begin;</p><p class="indent0">  decrease lamp-power by 1;</p><p class="indent0">  if lamp-power is 50, say &quot;<span class="quote">The lamp appears to be getting dimmer.</span>&quot;;</p><p class="indent0">  if lamp-power is 30, say &quot;<span class="quote">The lamp appears to be getting dimmer.</span>&quot;;</p><p class="indent0">  if lamp-power is 20, say &quot;<span class="quote">The lamp appears to be getting dimmer.</span>&quot;;</p><p class="indent0">  if lamp-power is 10, say &quot;<span class="quote">The lamp appears to be getting dimmer.</span>&quot;;</p><p class="indent0">  if lamp-power is  4, say  &quot;<span class="quote">The lamp is dying.</span>&quot;;</p><p class="indent0">  if lamp-power is 0 begin;</p><p class="indent0">    say &quot;<span class="quote">I hope you have more light than from a lamp.</span>&quot;;</p><p class="indent0">    now the battery-powered brass lantern is switched off;</p><p class="indent0">    now the battery-powered brass lantern is unlit;</p><p class="indent0">  end if;</p><p class="indent0">  end if;</p><p class="indent0">if the player has been in Living Room for the second turn and brochure flag is 1 begin;</p><p class="indent0">  say &quot;<span class="quote">There is a knocking sound from the front of the house.</span>&quot;;</p><p class="indent0">  now brochure flag is 2;</p><p class="indent0">  move the free brochure to the mailbox;</p><p class="indent0">end if;</p><p class="indent0">if the number of visible valuble things in the trophy case is 32 and the number of visible valuble things in the trophy case was not 32, say &quot;<span class="quote">Suddenly a sinister wraithlike figure, cloaked and hooded, appears</span></p><p class="indent0"><span class="quote">seeming to float in the air before you.  In a low, almost inaudible</span></p><p class="indent0"><span class="quote">voice he says, 'I welcome you to the ranks of the chosen of Zork. You</span></p><p class="indent0"><span class="quote">have persisted through many trials and tests, and have overcome them</span></p><p class="indent0"><span class="quote">all, dispelling the darkness of ignorance and danger.  One such as</span></p><p class="indent0"><span class="quote">yourself is fit to join even the Implementers!'  He then raises his</span></p><p class="indent0"><span class="quote">oaken staff, and chuckling, drifts away like a wisp of smoke, his</span></p><p class="indent0"><span class="quote">laughter fading in the distance.</span>&quot;.</p><p class="indent0">The rval of Narrow Corridor is 20.</p><p class="indent0">North of Narrow Corridor is a room called South Corridor.  The description of South Corridor is &quot;<span class="quote">This is an east-west corridor which turns north at its eastern and western ends.  The walls of the corridor are marble.  An additional passage leads south at the center of the corridor.</span>&quot;</p><p class="indent0">West of South Corridor is south of a room called West Corridor.  The description of West Corridor is &quot;<span class="quote">This is a corridor with polished marble walls.  The corridor</span></p><p class="indent0"><span class="quote">widens into larger areas as it turns east at its northern and</span></p><p class="indent0"><span class="quote">southern ends.</span>&quot;</p><p class="indent0">East of South corridor is south of a room called East Corridor.  The description of East Corridor is &quot;<span class="quote">This is a corridor with polished marble walls.  The corridor widens into larger areas as it turns west at its northern and southern ends.</span>&quot;</p><p class="indent0">North of West Corridor is a room called North Corridor.  The description of North Corridor is &quot;<span class="quote">This is a large east-west corridor which opens out to a northern</span></p><p class="indent0"><span class="quote">parapet at its center.  You can see flames and smoke as you peer</span></p><p class="indent0"><span class="quote">towards the parapet.  The corridor turns south at its east and west</span></p><p class="indent0"><span class="quote">ends, and due south is a massive wooden door.  In the door is a small</span></p><p class="indent0"><span class="quote">window barred with iron.  The door is [</span><span class="substitution">if the prison cell door is open</span><span class="quote">]open[</span><span class="substitution">otherwise</span><span class="quote">]closed.[</span><span class="substitution">end if</span><span class="quote">]</span>&quot;.</p><p class="indent0">North of East Corridor is North Corridor.</p><p class="indent0">North of North Corridor is a room called Parapet.  The description of Parapet is &quot;<span class="quote">You are standing behind a stone retaining wall which rims a large parapet overlooking a fiery pit.  It is difficult to see through the smoke and flame which fills the pit, but it seems to be more or less bottomless.  It also extends upward out of sight.  The pit itself is of roughly dressed stone and circular in shape.  It is about two hundred feet in diameter.  The flames generate considerable heat, so it is rather uncomfortable standing here.</span></p><p class="indent0"><span class="quote">There is an object here which looks like a sundial.  On it are an indicator arrow and (in the center) a large button.  On the face of the dial are numbers 'one' through 'eight'.  The indicator points to the number [</span><span class="substitution">dial number in words</span><span class="quote">].</span>&quot;</p><p class="indent0">Dial number is a number that varies. Dial number is 1.</p><p class="indent0">Persuasion rule for asking the dungeon master to try doing something: persuasion succeeds.</p><p class="indent0">A large button is in Parapet.  The large button is scenery.</p><p class="indent0">Persuasion rule for asking the dungeon master to try going:</p><p class="indent0">say &quot;<span class="quote">'I prefer to stay where I am, thank you.'</span>&quot;.</p><p class="indent0">A dial is in Parapet. The dial is scenery. Understand &quot;<span class="quote">sun dial</span>&quot; and &quot;<span class="quote">sundial</span>&quot; and &quot;<span class="quote">sun-dial</span>&quot; and &quot;<span class="quote">indicator</span>&quot; and &quot;<span class="quote">arrow</span>&quot; as the dial.</p><p class="indent0">Check taking the dungeon master: say &quot;<span class="quote">'I'm willing to accompany you, but not ride in your pocket!'</span>&quot; instead.</p><p class="indent0">Instead of asking the dungeon master to try doing something:</p><p class="indent0">  say &quot;<span class="quote">'If you wish,' he replies.</span>&quot;; continue the action.</p><p class="indent0">The prison cell door is a door.  The prison cell door is closed and openable.  The prison cell door is south of North Corridor.  South of the prison cell door is a room called Prison Cell.  </p><p class="indent0">The description of Prison Cell is &quot;<span class="quote">You are in a featureless prison cell.  You can see [</span><span class="substitution">if the prison cell door is open</span><span class="quote">]the east-west corridor outside the open wooden door in front of you.[</span><span class="substitution">otherwise</span><span class="quote">]only the flames and smoke of the pit out the small window in a closed door in front of you.[</span><span class="substitution">end if</span><span class="quote">].</span>&quot;</p><p class="indent0">PCell is a room.  The description of PCell is &quot;<span class="quote">You are in a featureless prison cell.  Its wooden door is securely fastened, and you can see only the flames and smoke of the pit out the small window.</span>&quot; The printed name of PCell is &quot;<span class="quote">Prison Cell</span>&quot;.</p><p class="indent0">The prison cell door is scenery.</p><p class="indent0">NCell is a room. The description of NCell is &quot;<span class="quote">You are in a featureless prison cell.  Its wooden door is securely fastened, and you can see only the flames and smoke of the pit out its small window.  On the other side of the cell is a bronze door which seems to be [</span><span class="substitution">if the bronze door is open</span><span class="quote">]open[</span><span class="substitution">otherwise</span><span class="quote">]closed[</span><span class="substitution">end if</span><span class="quote">].</span>&quot;. The printed name of NCell is &quot;<span class="quote">Prison Cell</span>&quot;.</p><p class="indent0">Check going inside while the location is NCell: try entering the bronze door instead.</p><p class="indent0">The bronze door is a door.  The bronze door is closed and openable.  </p><p class="indent0">The bronze door is scenery.  The bronze door is south of NCell.  South of the Bronze Door is a room called Treasury of Zork. The description of Treasury of Zork is </p><p class="indent0">&quot;<span class="quote">[</span><span class="substitution">5 spaces</span><span class="quote">]This is a room of large size, richly appointed and decorated</span></p><p class="indent0"><span class="quote">in a style that bespeaks exquisite taste.  To judge from its</span></p><p class="indent0"><span class="quote">contents, it is the ultimate storehouse of the treasures of Zork.[</span><span class="substitution">paragraph break</span><span class="quote">]</span></p><p class="indent0"><span class="quote">[</span><span class="substitution">5 spaces</span><span class="quote">]There are chests here containing precious jewels, mountains of</span></p><p class="indent0"><span class="quote">zorkmids, rare paintings, ancient statuary, and beguiling curios.[</span><span class="substitution">paragraph break</span><span class="quote">]</span></p><p class="indent0"><span class="quote">[</span><span class="substitution">5 spaces</span><span class="quote">]In one corner of the room is a bookcase boasting such volumes as</span></p><p class="indent0"><span class="quote">'The History of the Great Underground Empire,' 'The Lives of the</span></p><p class="indent0"><span class="quote">Twelve Flatheads,' 'The Wisdom of the Implementors,' and other</span></p><p class="indent0"><span class="quote">informative and inspiring works.[</span><span class="substitution">paragraph break</span><span class="quote">]</span></p><p class="indent0"><span class="quote">[</span><span class="substitution">5 spaces</span><span class="quote">]On one wall is a completely annotated map of the Great Underground</span></p><p class="indent0"><span class="quote">Empire, showing points of interest, various troves of treasure, and</span></p><p class="indent0"><span class="quote">indicating the locations of several superior scenic views.[</span><span class="substitution">paragraph break</span><span class="quote">]</span></p><p class="indent0"><span class="quote">[</span><span class="substitution">5 spaces</span><span class="quote">]On a desk at the far end of the room may be found stock</span></p><p class="indent0"><span class="quote">certificates representing a controlling interest in FrobozzCo</span></p><p class="indent0"><span class="quote">International, the multinational conglomerate and parent company of</span></p><p class="indent0"><span class="quote">the Frobozz Magic Boat Co., etc.[</span><span class="substitution">paragraph break</span><span class="quote">]</span>&quot;.</p><p class="indent0">Last every turn rule:</p><p class="indent0">if the player is in Treasury of Zork begin;</p><p class="indent0">  award 35 points;</p><p class="indent0">  say &quot;<span class="quote">[</span><span class="substitution">5 spaces</span><span class="quote">]As you gleefully examine your new-found riches, the Dungeon</span></p><p class="indent0"><span class="quote">Master himself materializes beside you, and says, 'Now that you have solved all the mysteries of the Dungeon, it is time for you to assume your rightly-earned place in the scheme of things.  Long have I waited for one capable of releasing me from my burden!'  He taps you lightly on the head with his staff, mumbling a few well-chosen spells,</span></p><p class="indent0"><span class="quote">and you feel yourself changing, growing older and more stooped.  For a moment there are two identical mages staring at each other among the treasure, then you watch as your counterpart dissolves into a mist and disappears, a sardonic grin on his face.</span>&quot;;</p><p class="indent0">  end the game in victory;</p><p class="indent0">end if.</p><p class="indent0">After deciding the scope of the player: </p><p class="indent0">if the player is in Prison Cell, place the dungeon master in scope.</p><p class="indent0">A thing has a number called cell number.  The cell number of a thing is usually 0.</p><p class="indent0">Every turn when something is in Prison Cell:</p><p class="indent0">repeat with thingy running through things in Prison Cell begin;</p><p class="indent0">  now the cell number of the thingy is current cell;</p><p class="indent0">end repeat.</p><p class="indent0">Limbo is a room.</p><p class="indent0">Current cell is a number that varies.  Current cell is 1.</p><p class="indent0">Instead of someone pushing the large button:</p><p class="indent0"> say &quot;<span class="quote">Click.</span>&quot;;</p><p class="indent0"> now the current cell is dial number;</p><p class="indent0"> if dial number is 6 and the player is in Prison Cell, move the player to NCell;</p><p class="indent0"> if the player is in Prison Cell, move the player to PCell;</p><p class="indent0"> now every thing in Prison Cell is in Limbo;</p><p class="indent0"> if the cell number of the player is dial number and the player is in PCell or the player is in NCell, move the player to Prison Cell;</p><p class="indent0"> repeat with thingy running through things in Limbo begin;</p><p class="indent0"> if the cell number of the thingy is dial number, move the thingy to Prison Cell;</p><p class="indent0"> if the player is in PCell and the cell number of the thingy is the cell number of the player, move the thingy to PCell;</p><p class="indent0"> if the player is in NCell and the cell number of the thingy is the cell number of the player, move the thingy to NCell;</p><p class="indent0">end repeat;</p><p class="indent0">repeat with thingy running through things in NCell begin;</p><p class="indent0">  if cell number of the thingy is dial number, move the thingy to Prison Cell;</p><p class="indent0">end repeat;</p><p class="indent0"> rule succeeds.</p><p class="indent0">Check going inside while the location is Hallway4: try entering the large wooden door instead.</p><p class="indent0">Include (-<span class="i6code"> [ XOR a b; return (a | b) &amp; (~(a &amp; b)); ];  </span>-). <a name="note2ref"></a><span class="notecue"><a href="#note2">[2]</a></span></p>
</div>

<div class ="notes">
<p><span class="notesheading">Notes</span></p>
<p><a name="note1"></a><span class="notetext"><a href="#note1ref">[1]</a>.  OK, this sort of doesn't make sense if the player is outside</span></p>
<p><a name="note2"></a><span class="notetext"><a href="#note2ref">[2]</a>.  Inform does not have a bitwise exclusive or built in, so we make one</span></p>

</div>

</div>

</body>

</html>
